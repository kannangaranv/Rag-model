<div class="chat-wrapper">
  <header class="chat-header">
    <div class="title">AI-Assistant</div>
  </header>

  <section #msgPane class="messages" role="log" aria-live="polite">
    <div
      *ngFor="let m of chatMessages"
      class="msg-row"
      [class.right]="m.role === 'user'"
      [class.left]="m.role === 'assistant'"
    >
      <div class="avatar" aria-hidden="true">
        <img
          *ngIf="m.role==='assistant'"
          src="assets/images/assistant.png"
          class="avatar-img"
        />
        <img
          *ngIf="m.role==='user'"
          src="assets/images/user.png"
          class="avatar-img"
        />
      </div>

      <div class="bubble" [class.user]="m.role==='user'" [class.assistant]="m.role==='assistant'">
        <div *ngIf="m.isHtml; else textTpl" [innerHTML]="m.content"></div>
        <ng-template #textTpl>{{ m.content }}</ng-template>
      </div>
    </div>

    <div class="msg-row left" *ngIf="isLoading">
      <div class="avatar">
        <img src="assets/images/assistant.png"  class="avatar-img" />
      </div>
      <div class="bubble assistant">
        <span class="dots">
          <span></span><span></span><span></span>
        </span>
      </div>
    </div>
  </section>

  <footer class="composer">
    <textarea
      [(ngModel)]="userMessage"
      class="input"
      rows="1"
      placeholder="Type a messageâ€¦"
      (keydown.enter)="onEnter($event)"
    ></textarea>

    <button
      class="send-btn"
      (click)="sendMessage()"
      [disabled]="isLoading || !userMessage.trim()"
    >
      Send
    </button>
  </footer>

</div>
